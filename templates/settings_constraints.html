{% extends 'passwordcontrol/_layout' %}

{% set selectedNavItem = 'constraints' %}

{% block content %}

<form id="settings-form" method="post" class="centered" accept-charset="UTF-8" data-saveshortcut>
    <input type="hidden" name="action" value="passwordControl/settings/save">
    <input type="hidden" name="settingsForm" value="constraints">
    {{ getCsrfInput() }}

    <h2>{{ 'Password Constraints'|t }}</h2>
    <p>{{ 'Password constraints define the conditions a user password needs to meet before the password is accepted.'|t }}</p>
    <p>{{ 'Setting a value in one of the constraint fields below activates that constraint. Leaving a field blank results in that constraint being ignored.'|t }}</p>
    <p>{{ "Example: setting the 'Length' constraint to 8, the 'Uppercase' constraint to 1, and the 'Punctuation' constraint to 1 means that a user password must have at least 8 characters with at least one uppercase letter and at least 1 punctuation character before it is accepted."|t }}</p>
    <p>{{ "Note: After setting constraint values, it's a good idea to test the constraints in the 'Test' password field below before enabling constraints for your users."|t }}</p>
    <hr>

    {{ forms.textField({
    label: 'Length'|t,
    name: 'constraint_length',
    size: 10,
    maxlength: 2,
    value: settings.constraint_length,
    instructions: 'The password must be equal to or longer than the specified minimum length.'|t
    }) }}

    {{ forms.textField({
    label: 'Letters'|t,
    name: 'constraint_letters',
    size: 10,
    maxlength: 2,
    value: settings.constraint_letters,
    instructions: 'The password must contain the specified minimum number of letters.'|t
    }) }}

    {{ forms.textField({
    label: 'Lowercase'|t,
    name: 'constraint_lowercase',
    size: 10,
    maxlength: 2,
    value: settings.constraint_lowercase,
    instructions: 'The password must contain the specified minimum number of lowercase letters.'|t
    }) }}

    {{ forms.textField({
    label: 'Uppercase'|t,
    name: 'constraint_uppercase',
    size: 10,
    maxlength: 2,
    value: settings.constraint_uppercase,
    instructions: 'The password must contain the specified minimum number of uppercase letters.'|t
    }) }}

    {{ forms.textField({
    label: 'Punctuation'|t,
    name: 'constraint_punctuation',
    size: 10,
    maxlength: 2,
    value: settings.constraint_punctuation,
    instructions: 'The password must contain the specified minimum number of punctuation (not whitespace or alphanumeric) characters.'|t
    }) }}

    {{ forms.textField({
    label: 'Numbers'|t,
    name: 'constraint_numbers',
    size: 10,
    maxlength: 2,
    value: settings.constraint_numbers,
    instructions: 'The password must contain the specified minimum number of numbers.'|t
    }) }}

    <hr>

    {{ forms.textField({
    label: 'Test Constraints'|t,
    name: 'constraint_test',
    size: 30,
    value: '',
    instructions: 'Type various combinations of password into the following field to test the constraints above.'|t
    }) }}

    <hr>

    {{ forms.lightswitchField({
    label: 'Enabled'|t,
    instructions: 'Enable these password constraints for your users.',
    name: 'enabled',
    on: settings.enabled,
    }) }}

    <hr>

    <div class="buttons">
        <input type="submit" class="btn submit" value="{{ 'Save'|t }}">
    </div>
</form>

{% endblock %}